(function($){$.fn.conditionize=function(options){var settings=$.extend({updateOn:["change"],handlers:["toggleVisibility"]},options);var handler=function(n,i){settings.handlers.forEach(function(e){if(typeof e==="string"&&$.fn.conditionize.handlers[e]){$.fn.conditionize.handlers[e](n,i)}else{if(typeof e==="function"){e(n,i)}}})};return this.each(function(){var $section=$(this);var cond=$(this).data("condition");var allFields=[];cond=cond.replace($.fn.conditionize.re,function(e,n){var i=n.substring(0,1)==="#"?n:"[name='"+n+"']";if($(i).length){if(allFields.indexOf(i)===-1){allFields.push(i)}return'$.fn.conditionize.getValue("'+i+'")'}else{return n}});allFields.forEach(function(field){$(field).on(settings.updateOn.join(" "),function(){handler(eval(cond),$section)})});handler(eval(cond),$section)})};$.extend($.fn.conditionize,{re:new RegExp("(#?[a-z0-9_\\[\\]-]+)"+"(?:(?=([^\"]*\"[^\"]*\")*[^\"]*$)(?=([^']*'[^']*')*[^']*$))","gi"),getValue:function(e){var n;if($(e).attr("type")==="radio"){n=$(e+":checked").val()}else{n=$(e).map(function(){if($(this).attr("type")==="checkbox"){return this.checked?this.value:false}else{return $(this).val()}}).get();if(n.length===1){n=n[0]}}return n},handlers:{toggleVisibility:function(e,n){if(e){n.slideDown()}else{n.slideUp()}},clearFieldsIfNotMet:function(e,n){if(!e){n.find("select, input").each(function(){if($(this).attr("type")==="radio"||$(this).attr("type")==="checkbox"){$(this).prop("checked",false).trigger("change")}else{$(this).val("").trigger("change")}})}},clearFieldsIfMet:function(e,n){this.clearFieldsIfNotMet(!e,n)}}})})(jQuery);
